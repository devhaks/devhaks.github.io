
<!DOCTYPE html>
<html lang="en,default">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Devhaks 개발 저장소">
    <title>웹 서버 개발의 Session 전략 - Devhaks 개발 저장소</title>
    <meta name="author" content="이종학">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"이종학","sameAs":["https://github.com/devhaks/"],"image":"https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d"},"articleBody":"\n들어가기 앞서 코드의 설명은 nodejs + express 로 하겠습니다.전체 소스 코드는 gitHub 를 참고하시면 됩니다.\n목차\n배경\n\nSession 이란\n\nSession의 저장 방식\n\nIn memory\nFile storage\nDatabase storage\n\n\n마치며\n\n\n배경이 글을 쓰게된 이유는 스스로의 궁금증을 풀고자 합니다. 저는 CMS 블로그 Wordpress 개발을 3년 정도 했었고 현재는 Parse 로 웹 서버 개발을 하고 있습니다. \n위 두 서비스의 DB 구조를 보면서 공통적인 부분을 발견했습니다.\n바로 Session 이 DB 에 저장되어 있다는 것입니다. 저의 의문은 여기서 시작 되었고 왜 Session 을 DB 에 저장하는지 이유를 파헤쳐보려 합니다.\nWordpress 는 블로그로 알려진 세계적인 CMS(컨텐츠 관리 시스템) 입니다. \nParse 는 백앤드 개발을 빠르고 쉽게 지원 하기 위해 각종 플랫폼(웹, 안드로이드, IOS) 에 맞는 api, sdk 를 제공합니다. 초기에 페이스북에서 BaaS(Backend as a Service)로 런칭했었고 현재는 오픈소스 입니다.\n\n\nSession 이란Session 을 이해하기 위해서는 먼저 ‘왜 Session 이란 개념이 생긴 것일까?’ 부터 이해 하셔야 합니다.모든 웹 서비스는 http 통신을 기본으로 하고 있습니다. http 통신은 서버와 클라이언트 간의 소통을 하기 위한 길 입니다. \n그러면 이 길을 누가 유지 하나요? 클라이언트 or 서버 일까요? 정답은 둘 다 유지 하지 않습니다. \n이러한 상황 때문에 http 는 stateless 특성을 갖습니다. 즉, 누구도 상태를 유지하지 않는다는 것이죠. 상태를 유지 하지 않으면 어떠한 상황이 발생 될까요? 예를 들면, 사용자가 온라인 구매 사이트에 접속하여 물품을 장바구니에 넣어놓고 다음날 다시 접속해서 확인하니 장바구니에 물품이 없는 상황이 발생합니다.\n위와 같은 상황이 발생하기 때문에 상태 유지를 위한 statefull 을 지원하기 위해 Session 개념이 생긴 것입니다.\nSession 만 얘기하면 서운한 녀석이 바로 Cookie 입니다. 쉽게 설명하면 클라이언트가 서버에 요청 했을 때, 요청한 사용자에게 증거를 남기기 위한 증거물을 Cookie 라고 이해 하시면 됩니다. \nSession의 저장 방식Session의 저장 방식은 3가지로 나눌 수 있습니다. 아래의 순서는 의미가 있습니다. 각 저장 방식에 따른 문제점을 보완한 단계를 의미합니다. 어떤 문제점이 있는지 확인하는 과정을 통해 설명 하겠습니다.\n\nIn memory\n\napp 을 구동하고 있는 서버의 메모리에 Session을 생성합니다.\n\n\nFile storage\n\napp 을 구동하고 있는 서버의 특정 디렉토리에 파일 형태로 Session을 생성합니다.\n\n\nDatabase storage\n\nfile storage 대신에 DB 에 저장합니다. \n\n\n\n\nIn memoryapp.js12345678910111213const session = require(\"express-session\");app.use(  session(&#123;    secret: \"yourPrivateKey\", // Session을 hash 하기 위한 비밀키 입니다.    resave: false,    saveUninitialized: true,    cookie: &#123;      secure: false,      maxAge: 600 * 1000 // Cookie의 생명 주기를 설정합니다.    &#125;  &#125;));\nroutes/index.js12345678910111213router.use(\"/session\", (req, res) =&gt; &#123;  const &#123; sessionID, cookies &#125; = req;  // 서버가 생성한 sessionID  console.log('sessionID:', sessionID);  // 클라이언트가 보유한 cookie  console.log('cookies.yourCookieName', cookies.yourCookieName);  res.json(&#123;    sessionID,    cookies  &#125;);&#125;);\nhttp://localhost:3030/session 로 접속해서 메모리에 Session을 저장 하겠습니다.\n첫번째 클라이언트가 요청 했을 때, Cookie는 없고 서버는 Cookie가 없음을 인지하고 메모리에 Session을 저장하고 클라이언트로 전달합니다. 응답 받은 클라이언트는 Cookie를 저장합니다.12345 // 첫번째 접속한 경우&#123;  sessionID: \"TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq\",  cookies: &#123; &#125;&#125;\n두번째 클라이언트가 요청 했을 때, 클라이언트는 서버로 Cookie를 전달하고 서버는 Cookie를 분석해서 메모리에 Session이 존재하는지 확인 합니다. Session이 존재하므로 Session을 다시 생성하지 않습니다. Session은 서버에 저장하고 Cookie는 클라이언트에 저장하여 statefull 상태가 됩니다. 이후 임의의 사용자가 웹 서비스를 이용할 때, 무엇을 했는지에 대한 추적이 가능해 집니다. (주의. 로그인과 동일시 생각하면 안됩니다.)1234567// 두번째 접속한 경우&#123;  sessionID: \"TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq\",  cookies: &#123;    yourCookieName: \"s:TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq.5Pykjnn5ekwwJUTDYnuxnXeO4N2Kdwbiske1xZegu+g\"  &#125;&#125;\n문제점 파헤치기\n자, 그러면 app 이 오류가 발생해서 죽었다고 가정합시다. app 을 재시작을 재접속하면 어떻게 될까요? Cookie는 그대로이지만 서버의 Session이 변경되었습니다. 왜 바뀌었는지 아시겠나요? app 을 재시작하면서 메모리에 저장된 Session은 모두 초기화 되었습니다. 그래서 Cookie는 동일 하지만 메모리에 Session이 없기 때문에 Session을 재생성 한 것입니다. Session이 변경되면 임의의 사용자가 무엇을 했는지에 대한 정보가 손실됩니다.\n1234567// 세번째 접속한 경우&#123;  sessionID: \"79SN6VIQvVh_b3Tfi0Ybw41zoboYNmMp\", // 변경된 Session  cookies: &#123;    yourCookieName: \"s:TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq.5Pykjnn5ekwwJUTDYnuxnXeO4N2Kdwbiske1xZegu+g\"  &#125;&#125;\n\napp 이 죽지 않고 잘 돌아가면 문제가 없을까요? 또 다른 이유로는 Memory 용량입니다. 메모리는 항상 제한적입니다. 사용자가 급격히 증가하면, Session이 차지하는 메모리는 증가하고 용량 app 은 시스템 메모리 초과로 인해 죽게 될 것입니다.\n\n\n\nFile storageIn Memory 방식의 문제점을 보완하여 파일형태로 Session을 저장하도록 하겠습니다.\napp.js\n12345678910111213const session = require(\"express-session\");// Session을 파일로 생성해주는 모듈const FileStore = require(\"session-file-store\")(session);app.use(  session(&#123;    name: \"yourCookieName\",    secret: \"yourPrivateKey\",    resave: false,    saveUninitialized: true,    store: new FileStore() // 모듈 적용  &#125;));\nhttp://localhost:3030/session 로 접속해서 Session 디렉토리 Session을 file 로 생성합니다.\nmYCHWOju_gFEiGM_tvxBvi2FtsVdepju.json (sessionId 값이 파일명이 됨.)123456789&#123;  cookie: &#123;     originalMaxAge: null,     expires: null,     httpOnly: true,     path: \"/\"   &#125;,  __lastAccess: 1555819224539&#125;;\n서버를 강제로 재시작 해도 Session file 은 그대로 유지되며, 임의 사용자에 대한 정보 손실을 막을 수 있게 되었습니다. 클라이언트의 Cookie도 그대로 입니다.123456&#123;  sessionID: \"mYCHWOju_gFEiGM_tvxBvi2FtsVdepju\",  cookies: &#123;    yourCookieName: \"s:mYCHWOju_gFEiGM_tvxBvi2FtsVdepju.tFSC7IGe+j0Dp9fHYtVFUZBD3E2NpvLWCW0u2PY+0NY\"  &#125;&#125;\n문제점 파헤치기이제 더 이상 문제가 없어 보이는데, 또 다른 문제가 있을까요? 문제가 될만한 상황을 만들겠습니다.\n로드 밸런서에 의한 트래픽 분산\n사용자의 급증으로 서버를 2대로 늘렸습니다. 기존 서버는 server_1, 새로운 서버는 server_2 입니다. 사용자는 로드 밸런서에 의해 분할되어 접속하게 됩니다.\n서버를 늘리기 전에 사용자는 온라인 사이트에 물품을 장바구니에 넣었습니다. 서버의 Session 파일에는 사용자의 장바구니 정보가 저장되어 있습니다. \n그런데 서버를 늘린 후에 사용자는 자신의 장바구니의 물품이 사라졌다고 합니다. 왜 이런 문제가 발생한 걸까요? 원인은 새로운 서버에 사용자의 Session 파일이 없기 때문입니다. 이와 같은 상황은 다음 그림과 동일하다 볼 수 있습니다.\n동일 사용자가 여러 디바이스로 접속\n실제 동일한 사용자이지만 여러 디바이스를 통해 접속 하므로 각각의 디바이스 마다 Session과 Cookie가 생성되는 것과 동일한 상황이라 볼 수 있습니다.\n그러면 위와 같은 문제를 어떻게 해결해야 할까요? 아쉽게도 Session 만으로는 한계가 있습니다. 여기까지가 Session의 역할은 다 했다고 생각합니다.\n\nDatabase storage마지막으로 DB에 Session을 저장하는 방법입니다. 이 부분은 file Storage에서의 Session 의 한계를 보완하고자 DB를 통해 로그인 기능이 필요한 이유 때문에 준비했습니다.\nSession을 저장하기 위한 DB\n위 그림은 app 서버는 2개이고 DB 서버는 1개인 상황입니다.\n사용자는 회원 가입을 하고 로그인을 합니다. DB 에는 사용자 정보를 저장하고 더 이상 Session으로 사용자 정보를 저장할 필요가 없습니다. 로그인을 통해 장바구니에 상품을 담는 것도 Session 대신에 DB에 저장하면 동일 유저의 여러 디바이스에서 로그인만 하면 내 장바구니 정보는 DB에서 불러오기만 하면 됩니다. \n그러면 ‘굳이 Session을 DB 에 저장할 필요가 없지 않나?’ 라는 생각이 하실겁니다. Session의 역할은 사용자의 정보를 저장하는 것 이외에 생명주기를 설정할 수 있습니다. 쉽게 말해서 로그인을 유지하기 위한 시간을 설정 할 수 있습니다. \nSession을 DB 로 관리하는 구현 방법을 설명하기에는 개발 환경마다 차이가 있으므로 대신에 제가 사용 중인 Parse 오픈소스에서는 아래와 같이 사용자의 Session 을 관리하고 있습니다.\nParse Dashboard Session Collection\nMongoDB 를 사용 중이며 위 그림의 Session Collection 을 살펴보면, sessionToken 과 expiresAt(로그인 유지 만료시간), user(사용자 외래키) 속성이 있습니다. sessionToken 을 자세히 설명하면 사용자가 로그인 후에 주어지는 입장권 같은 것입니다. 입장권이 있으면 서비스를 이용할 때, 매번 로그인(ID,PW 입력)을 할 필요 없이 DB 에서는 sessionToken(입장권) 을 비교하고 expiresAt(만료일)이 지났는지 확인합니다. 사용자는 더 간편하게 서비스를 이용 할 수 있죠. 또한 동일한 사용자이면서 여러 디바이스 마다 recode 를 생성하여 1:N 관계로 Session을 관리 할 수 있게 됩니다.\n마치며이번 글을 정리하면서 느낀점은 개념에 대한 이해를 넘어서 기존의 문제점을 분석하고 더 나은 방법을 채택하는 이유에 대해서 파헤쳐보는 것에 프로그래밍과는 또 다른 흥미를 느꼈습니다.\n번외로 개발자분들이 Session과 Cookie에 대해 얼마나 알고 계신지 궁금하여 생활코딩을 통해서 설문조사를 진행 했습니다.글을 쓰면서 생각해보니 Session을 DB 에 저장하는 이유를 알고 있다 라는 항목을 잘 못 적었다는 생각이 드네요. 정확히는 Session의 한계를 알고 로그인 기능이 필요한 이유를 알고 있다 라고 했어야 했네요.","dateCreated":"2019-04-20T23:32:01+09:00","dateModified":"2019-06-01T01:04:41+09:00","datePublished":"2019-04-20T23:32:01+09:00","description":"이번 포스팅은 웹 서버 개발에 Session 의 문제점과 서비스 환경에 따른 전략 대해 설명합니다.","headline":"웹 서버 개발의 Session 전략","image":["thumbnail.png","cover.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://devhaks.github.io/2019/04/20/session-strategy/"},"publisher":{"@type":"Organization","name":"이종학","sameAs":["https://github.com/devhaks/"],"image":"https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d"}},"url":"https://devhaks.github.io/2019/04/20/session-strategy/","keywords":"session, cookie","thumbnailUrl":"thumbnail.png"}</script>
    
    
    
        
    

    
        <meta property="og:image" content="https://devhaks.github.io/2019/04/20/session-strategy/thumbnail.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://devhaks.github.io/2019/04/20/session-strategy/thumbnail.png" />
    
    
    
        <meta property="og:image" content="https://devhaks.github.io/2019/04/20/session-strategy/cover.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://devhaks.github.io/2019/04/20/session-strategy/cover.jpg" />
    
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=640"/>
    
    
    

    <meta name="description" content="웹 서버 개발에 Session 의 문제점과 서비스 환경에 따른 전략에 대해 설명합니다.">
<meta name="keywords" content="session,cookie">
<meta property="og:type" content="blog">
<meta property="og:title" content="웹 서버 개발의 Session 전략">
<meta property="og:url" content="https://devhaks.github.io/2019/04/20/session-strategy/index.html">
<meta property="og:site_name" content="Devhaks 개발 저장소">
<meta property="og:description" content="웹 서버 개발에 Session 의 문제점과 서비스 환경에 따른 전략에 대해 설명합니다.">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://devhaks.github.io/2019/04/20/session-strategy/example1.png">
<meta property="og:image" content="https://devhaks.github.io/2019/04/20/session-strategy/example3.png">
<meta property="og:image" content="https://devhaks.github.io/2019/04/20/session-strategy/example2.png">
<meta property="og:image" content="https://devhaks.github.io/2019/04/20/session-strategy/dbstorage.png">
<meta property="og:image" content="https://devhaks.github.io/2019/04/20/session-strategy/facebook.jpeg">
<meta property="og:updated_time" content="2019-05-31T16:04:41.037Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="웹 서버 개발의 Session 전략">
<meta name="twitter:description" content="웹 서버 개발에 Session 의 문제점과 서비스 환경에 따른 전략에 대해 설명합니다.">
<meta name="twitter:image" content="https://devhaks.github.io/2019/04/20/session-strategy/example1.png">


    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-dig2yh02rpgcdxsbsfha8ujj65grwfvm3xbp1gpa6w8uj8k150ymhv97ed5p.min.css">
    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135461398-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-135461398-1');
    </script>


    
</head>

    <body>
        
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Devhaks 개발 저장소</a>
    </div>

    <div class="progress-container">
        <div class="progress-bar" id="myBar"></div>
    </div>
    


    
        
            <a class="header-right-picture " href="/me">
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=90" alt="Author&#39;s picture">
        
        </a>
    
</header>


<style>
    /* The progress container (grey background) */
    .progress-container {
        width: 100%;
        height: 10px;
        background: #ccc;
        
    }
    /* The progress bar (scroll indicator) */
    .progress-bar {
        height: 10px;
        background: #ff5151;
        width: 0%;
    }
</style>

<script>
    // When the user scrolls the page, execute myFunction 
    window.onscroll = function() {myFunction()};

    function myFunction() {
        var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
        var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        var scrolled = (winScroll / height) * 100;
        document.getElementById("myBar").style.width = scrolled + "%";
    }
</script>
            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=110" alt="Author&#39;s picture">
                </a>
                <h4 class="sidebar-profile-name">이종학</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/ " title="Home">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" title="Categories">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" title="Tags">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" title="Archives">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link open-algolia-search" href="#search" title="Search">
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/me" title="About">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/devhaks/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-left
                    post-header-cover--full" style="background-image:url('/2019/04/20/session-strategy/cover.jpg');" data-behavior="5">
            
                <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            웹 서버 개발의 Session 전략
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-04-20T23:32:01+09:00">
	
		    Apr 20, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Server/">Server</a>, <a class="category-link" href="/categories/Server/Web/">Web</a>


    
</div>

    
</div>

            
        </div>

            <div id="main" data-behavior="5"
                 class="hasCover
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    

    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- excerpt -->
<p>들어가기 앞서 코드의 설명은 nodejs + express 로 하겠습니다.<br>전체 소스 코드는 <a href="https://github.com/devhaks/myNode/tree/session" target="_blank" rel="noopener">gitHub</a> 를 참고하시면 됩니다.</p>
<h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul>
<li><p><a href="#배경">배경</a></p>
</li>
<li><p><a href="#Session-이란">Session 이란</a></p>
</li>
<li><p><a href="#Session의-저장-방식">Session의 저장 방식</a></p>
<ul>
<li><a href="#In-memory">In memory</a></li>
<li><a href="#File-storage">File storage</a></li>
<li><a href="#Database-storage">Database storage</a></li>
</ul>
</li>
<li><p><a href="#마치며">마치며</a></p>
</li>
</ul>
<h2 id="배경"><a href="#배경" class="headerlink" title="배경"></a>배경</h2><p>이 글을 쓰게된 이유는 스스로의 궁금증을 풀고자 합니다. 저는 CMS 블로그 <a href="https://ko.wordpress.org/" target="_blank" rel="noopener">Wordpress</a> 개발을 3년 정도 했었고 현재는 <a href="https://parseplatform.org/" target="_blank" rel="noopener">Parse</a> 로 웹 서버 개발을 하고 있습니다. </p>
<p>위 두 서비스의 DB 구조를 보면서 공통적인 부분을 발견했습니다.</p>
<p>바로 Session 이 DB 에 저장되어 있다는 것입니다. 저의 의문은 여기서 시작 되었고 왜 Session 을 DB 에 저장하는지 이유를 파헤쳐보려 합니다.</p>
<div class="alert info"><p>Wordpress 는 블로그로 알려진 세계적인 CMS(컨텐츠 관리 시스템) 입니다. </p>
<p>Parse 는 백앤드 개발을 빠르고 쉽게 지원 하기 위해 각종 플랫폼(웹, 안드로이드, IOS) 에 맞는 api, sdk 를 제공합니다. 초기에 페이스북에서 BaaS(Backend as a Service)로 런칭했었고 현재는 오픈소스 입니다.</p>
</div>
<hr>
<h2 id="Session-이란"><a href="#Session-이란" class="headerlink" title="Session 이란"></a>Session 이란</h2><p>Session 을 이해하기 위해서는 먼저 ‘왜 Session 이란 개념이 생긴 것일까?’ 부터 이해 하셔야 합니다.<br>모든 웹 서비스는 http 통신을 기본으로 하고 있습니다. http 통신은 서버와 클라이언트 간의 소통을 하기 위한 길 입니다. </p>
<p>그러면 이 길을 누가 유지 하나요? 클라이언트 or 서버 일까요? 정답은 둘 다 유지 하지 않습니다. </p>
<p>이러한 상황 때문에 http 는 <code>stateless</code> 특성을 갖습니다. 즉, 누구도 상태를 유지하지 않는다는 것이죠. 상태를 유지 하지 않으면 어떠한 상황이 발생 될까요? 예를 들면, 사용자가 온라인 구매 사이트에 접속하여 물품을 장바구니에 넣어놓고 다음날 다시 접속해서 확인하니 장바구니에 물품이 없는 상황이 발생합니다.</p>
<p>위와 같은 상황이 발생하기 때문에 상태 유지를 위한 <code>statefull</code> 을 지원하기 위해 Session 개념이 생긴 것입니다.</p>
<p>Session 만 얘기하면 서운한 녀석이 바로 Cookie 입니다. 쉽게 설명하면 클라이언트가 서버에 요청 했을 때, 요청한 사용자에게 증거를 남기기 위한 증거물을 Cookie 라고 이해 하시면 됩니다. </p>
<h2 id="Session의-저장-방식"><a href="#Session의-저장-방식" class="headerlink" title="Session의 저장 방식"></a>Session의 저장 방식</h2><p>Session의 저장 방식은 3가지로 나눌 수 있습니다. 아래의 순서는 의미가 있습니다. 각 저장 방식에 따른 문제점을 보완한 단계를 의미합니다. 어떤 문제점이 있는지 확인하는 과정을 통해 설명 하겠습니다.</p>
<ol>
<li><p><a href="#In-memory">In memory</a></p>
<ul>
<li>app 을 구동하고 있는 서버의 메모리에 Session을 생성합니다.</li>
</ul>
</li>
<li><p><a href="#File-storage">File storage</a></p>
<ul>
<li>app 을 구동하고 있는 서버의 특정 디렉토리에 파일 형태로 Session을 생성합니다.</li>
</ul>
</li>
<li><p><a href="#Database-storage">Database storage</a></p>
<ul>
<li>file storage 대신에 DB 에 저장합니다. </li>
</ul>
</li>
</ol>
<hr>
<h4 id="In-memory"><a href="#In-memory" class="headerlink" title="In memory"></a>In memory</h4><p>app.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">"express-session"</span>);</span><br><span class="line"></span><br><span class="line">app.use(</span><br><span class="line">  session(&#123;</span><br><span class="line">    secret: <span class="string">"yourPrivateKey"</span>, <span class="comment">// Session을 hash 하기 위한 비밀키 입니다.</span></span><br><span class="line">    resave: <span class="literal">false</span>,</span><br><span class="line">    saveUninitialized: <span class="literal">true</span>,</span><br><span class="line">    cookie: &#123;</span><br><span class="line">      secure: <span class="literal">false</span>,</span><br><span class="line">      maxAge: <span class="number">600</span> * <span class="number">1000</span> <span class="comment">// Cookie의 생명 주기를 설정합니다.</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>routes/index.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">router.use(<span class="string">"/session"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; sessionID, cookies &#125; = req;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 서버가 생성한 sessionID</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'sessionID:'</span>, sessionID);</span><br><span class="line">  <span class="comment">// 클라이언트가 보유한 cookie</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'cookies.yourCookieName'</span>, cookies.yourCookieName);</span><br><span class="line"></span><br><span class="line">  res.json(&#123;</span><br><span class="line">    sessionID,</span><br><span class="line">    cookies</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><a href="http://localhost:3030/session" target="_blank" rel="noopener">http://localhost:3030/session</a> 로 접속해서 메모리에 Session을 저장 하겠습니다.</p>
<p>첫번째 클라이언트가 요청 했을 때, Cookie는 없고 서버는 Cookie가 없음을 인지하고 메모리에 Session을 저장하고 클라이언트로 전달합니다. 응답 받은 클라이언트는 Cookie를 저장합니다.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> // 첫번째 접속한 경우</span><br><span class="line">&#123;</span><br><span class="line">  sessionID: "TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq",</span><br><span class="line">  cookies: &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>두번째 클라이언트가 요청 했을 때, 클라이언트는 서버로 Cookie를 전달하고 서버는 Cookie를 분석해서 메모리에 Session이 존재하는지 확인 합니다. Session이 존재하므로 Session을 다시 생성하지 않습니다. Session은 서버에 저장하고 Cookie는 클라이언트에 저장하여 <code>statefull</code> 상태가 됩니다. 이후 임의의 사용자가 웹 서비스를 이용할 때, 무엇을 했는지에 대한 추적이 가능해 집니다. (주의. 로그인과 동일시 생각하면 안됩니다.)<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 두번째 접속한 경우</span><br><span class="line">&#123;</span><br><span class="line">  sessionID: "TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq",</span><br><span class="line">  cookies: &#123;</span><br><span class="line">    yourCookieName: "s:TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq.5Pykjnn5ekwwJUTDYnuxnXeO4N2Kdwbiske1xZegu+g"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="문제점-파헤치기"><a href="#문제점-파헤치기" class="headerlink" title="문제점 파헤치기"></a>문제점 파헤치기</h5><ol>
<li><p><u>자, 그러면 app 이 오류가 발생해서 죽었다고 가정합시다.</u> app 을 재시작을 재접속하면 어떻게 될까요? Cookie는 그대로이지만 서버의 Session이 변경되었습니다. 왜 바뀌었는지 아시겠나요? app 을 재시작하면서 메모리에 저장된 Session은 모두 초기화 되었습니다. 그래서 Cookie는 동일 하지만 메모리에 Session이 없기 때문에 Session을 재생성 한 것입니다. Session이 변경되면 임의의 사용자가 무엇을 했는지에 대한 정보가 손실됩니다.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 세번째 접속한 경우</span><br><span class="line">&#123;</span><br><span class="line">  sessionID: "79SN6VIQvVh_b3Tfi0Ybw41zoboYNmMp", // 변경된 Session</span><br><span class="line">  cookies: &#123;</span><br><span class="line">    yourCookieName: "s:TcZ8P0XZMk4gBb3mhWH4-NHXnOGBJSFq.5Pykjnn5ekwwJUTDYnuxnXeO4N2Kdwbiske1xZegu+g"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>app 이 죽지 않고 잘 돌아가면 문제가 없을까요? 또 다른 이유로는 <code>Memory</code> 용량입니다. 메모리는 항상 제한적입니다. 사용자가 급격히 증가하면, Session이 차지하는 메모리는 증가하고 용량 app 은 시스템 메모리 초과로 인해 죽게 될 것입니다.</p>
</li>
</ol>
<hr>
<h4 id="File-storage"><a href="#File-storage" class="headerlink" title="File storage"></a>File storage</h4><p>In Memory 방식의 문제점을 보완하여 파일형태로 Session을 저장하도록 하겠습니다.</p>
<p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">"express-session"</span>);</span><br><span class="line"><span class="comment">// Session을 파일로 생성해주는 모듈</span></span><br><span class="line"><span class="keyword">const</span> FileStore = <span class="built_in">require</span>(<span class="string">"session-file-store"</span>)(session);</span><br><span class="line"></span><br><span class="line">app.use(</span><br><span class="line">  session(&#123;</span><br><span class="line">    name: <span class="string">"yourCookieName"</span>,</span><br><span class="line">    secret: <span class="string">"yourPrivateKey"</span>,</span><br><span class="line">    resave: <span class="literal">false</span>,</span><br><span class="line">    saveUninitialized: <span class="literal">true</span>,</span><br><span class="line">    store: <span class="keyword">new</span> FileStore() <span class="comment">// 모듈 적용</span></span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><a href="http://localhost:3030/session" target="_blank" rel="noopener">http://localhost:3030/session</a> 로 접속해서 Session 디렉토리 Session을 file 로 생성합니다.</p>
<p>mYCHWOju_gFEiGM_tvxBvi2FtsVdepju.json (sessionId 값이 파일명이 됨.)<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  cookie: &#123; </span><br><span class="line">    originalMaxAge: null, </span><br><span class="line">    expires: null, </span><br><span class="line">    httpOnly: true, </span><br><span class="line">    path: "/" </span><br><span class="line">  &#125;,</span><br><span class="line">  __lastAccess: 1555819224539</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>서버를 강제로 재시작 해도 Session file 은 그대로 유지되며, 임의 사용자에 대한 정보 손실을 막을 수 있게 되었습니다. 클라이언트의 Cookie도 그대로 입니다.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  sessionID: "mYCHWOju_gFEiGM_tvxBvi2FtsVdepju",</span><br><span class="line">  cookies: &#123;</span><br><span class="line">    yourCookieName: "s:mYCHWOju_gFEiGM_tvxBvi2FtsVdepju.tFSC7IGe+j0Dp9fHYtVFUZBD3E2NpvLWCW0u2PY+0NY"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="문제점-파헤치기-1"><a href="#문제점-파헤치기-1" class="headerlink" title="문제점 파헤치기"></a>문제점 파헤치기</h5><p>이제 더 이상 문제가 없어 보이는데, 또 다른 문제가 있을까요? 문제가 될만한 상황을 만들겠습니다.</p>
<div class="figure center" style="width:;"><a class="fancybox" href="example1.png" title="로드 밸런서에 의한 트래픽 분산" data-caption="로드 밸런서에 의한 트래픽 분산" data-fancybox="travel"><img class="fig-img" src="example1.png" alt="로드 밸런서에 의한 트래픽 분산"></a><span class="caption">로드 밸런서에 의한 트래픽 분산</span></div><div style="clear:both;"></div>
<p>사용자의 급증으로 서버를 2대로 늘렸습니다. 기존 서버는 server_1, 새로운 서버는 server_2 입니다. 사용자는 로드 밸런서에 의해 분할되어 접속하게 됩니다.</p>
<p>서버를 늘리기 전에 사용자는 온라인 사이트에 물품을 장바구니에 넣었습니다. 서버의 Session 파일에는 사용자의 장바구니 정보가 저장되어 있습니다. </p>
<p>그런데 서버를 늘린 후에 사용자는 자신의 장바구니의 물품이 사라졌다고 합니다. 왜 이런 문제가 발생한 걸까요? 원인은 새로운 서버에 사용자의 Session 파일이 없기 때문입니다. 이와 같은 상황은 다음 그림과 동일하다 볼 수 있습니다.</p>
<div class="figure center" style="width:;"><a class="fancybox" href="example3.png" title="동일 사용자가 여러 디바이스로 접속" data-caption="동일 사용자가 여러 디바이스로 접속" data-fancybox="travel"><img class="fig-img" src="example3.png" alt="동일 사용자가 여러 디바이스로 접속"></a><span class="caption">동일 사용자가 여러 디바이스로 접속</span></div><div style="clear:both;"></div>
<p>실제 동일한 사용자이지만 여러 디바이스를 통해 접속 하므로 각각의 디바이스 마다 Session과 Cookie가 생성되는 것과 동일한 상황이라 볼 수 있습니다.</p>
<p>그러면 위와 같은 문제를 어떻게 해결해야 할까요? 아쉽게도 Session 만으로는 한계가 있습니다. 여기까지가 Session의 역할은 다 했다고 생각합니다.</p>
<hr>
<h4 id="Database-storage"><a href="#Database-storage" class="headerlink" title="Database storage"></a>Database storage</h4><p>마지막으로 DB에 Session을 저장하는 방법입니다. 이 부분은 file Storage에서의 Session 의 한계를 보완하고자 DB를 통해 로그인 기능이 필요한 이유 때문에 준비했습니다.</p>
<div class="figure center" style="width:;"><a class="fancybox" href="example2.png" title="Session을 저장하기 위한 DB" data-caption="Session을 저장하기 위한 DB" data-fancybox="travel"><img class="fig-img" src="example2.png" alt="Session을 저장하기 위한 DB"></a><span class="caption">Session을 저장하기 위한 DB</span></div><div style="clear:both;"></div>
<p>위 그림은 app 서버는 2개이고 DB 서버는 1개인 상황입니다.</p>
<p>사용자는 회원 가입을 하고 로그인을 합니다. DB 에는 사용자 정보를 저장하고 더 이상 Session으로 사용자 정보를 저장할 필요가 없습니다. 로그인을 통해 장바구니에 상품을 담는 것도 Session 대신에 DB에 저장하면 동일 유저의 여러 디바이스에서 로그인만 하면 내 장바구니 정보는 DB에서 불러오기만 하면 됩니다. </p>
<p>그러면 ‘굳이 Session을 DB 에 저장할 필요가 없지 않나?’ 라는 생각이 하실겁니다. Session의 역할은 사용자의 정보를 저장하는 것 이외에 생명주기를 설정할 수 있습니다. 쉽게 말해서 로그인을 유지하기 위한 시간을 설정 할 수 있습니다. </p>
<p>Session을 DB 로 관리하는 구현 방법을 설명하기에는 개발 환경마다 차이가 있으므로 대신에 제가 사용 중인 <a href="https://parseplatform.org/" target="_blank" rel="noopener">Parse</a> 오픈소스에서는 아래와 같이 사용자의 Session 을 관리하고 있습니다.</p>
<div class="figure center" style="width:;"><a class="fancybox" href="dbstorage.png" title="Parse Dashboard Session Collection" data-caption="Parse Dashboard Session Collection" data-fancybox="travel"><img class="fig-img" src="dbstorage.png" alt="Parse Dashboard Session Collection"></a><span class="caption">Parse Dashboard Session Collection</span></div><div style="clear:both;"></div>
<p>MongoDB 를 사용 중이며 위 그림의 <code>Session</code> Collection 을 살펴보면, sessionToken 과 expiresAt(로그인 유지 만료시간), user(사용자 외래키) 속성이 있습니다. sessionToken 을 자세히 설명하면 사용자가 로그인 후에 주어지는 입장권 같은 것입니다. 입장권이 있으면 서비스를 이용할 때, 매번 로그인(ID,PW 입력)을 할 필요 없이 DB 에서는 sessionToken(입장권) 을 비교하고 expiresAt(만료일)이 지났는지 확인합니다. 사용자는 더 간편하게 서비스를 이용 할 수 있죠. 또한 동일한 사용자이면서 여러 디바이스 마다 recode 를 생성하여 1:N 관계로 Session을 관리 할 수 있게 됩니다.</p>
<h2 id="마치며"><a href="#마치며" class="headerlink" title="마치며"></a>마치며</h2><p>이번 글을 정리하면서 느낀점은 개념에 대한 이해를 넘어서 기존의 문제점을 분석하고 더 나은 방법을 채택하는 이유에 대해서 파헤쳐보는 것에 프로그래밍과는 또 다른 흥미를 느꼈습니다.</p>
<p>번외로 개발자분들이 Session과 Cookie에 대해 얼마나 알고 계신지 궁금하여 생활코딩을 통해서 설문조사를 진행 했습니다.<br><div class="figure center" style="width:80%;"><a class="fancybox" href="facebook.jpeg" title data-caption data-fancybox="travel"><img class="fig-img" src="facebook.jpeg" style="width:80%;" alt></a></div><div style="clear:both;"></div><br>글을 쓰면서 생각해보니 <code>Session을 DB 에 저장하는 이유를 알고 있다</code> 라는 항목을 잘 못 적었다는 생각이 드네요. 정확히는 <code>Session의 한계를 알고 로그인 기능이 필요한 이유를 알고 있다</code> 라고 했어야 했네요.</p>
            

        </div>
    </div>

    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/cookie/">cookie</a> <a class="tag tag--primary tag--small t-link" href="/tags/session/">session</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/05/31/oauth2/" data-tooltip="카카오 로그인을 통한 Oauth2 이해하기" aria-label="PREVIOUS: 카카오 로그인을 통한 Oauth2 이해하기">
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="text-small icon-ml">카카오 로그인을 통한 Oauth2 이해하기</span>
                        <!-- <span class="hide-xs hide-sm text-small icon-ml">카카오 로그인을 통한 Oauth2 이해하기</span> -->
                
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/03/30/puppeteer/" data-tooltip="[nodejs] puppeteer 뉴스 기사 메타 정보 크롤링" aria-label="NEXT: [nodejs] puppeteer 뉴스 기사 메타 정보 크롤링">
                        <span class="text-small icon-mr">[nodejs] puppeteer 뉴스 기사 메타 정보 크롤링</span>
                        <!-- <span class="hide-xs hide-sm text-small icon-mr">[nodejs] puppeteer 뉴스 기사 메타 정보 크롤링</span> -->
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <!-- <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li> -->
        
            
            
            <li class="post-action">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://devhaks.github.io/2019/04/20/session-strategy/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://devhaks.github.io/2019/04/20/session-strategy/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <!-- <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top"> -->
            
                <!-- <i class="fa fa-list" aria-hidden="true"></i> -->
            <!-- </a> -->
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://devhaks.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
            
        
    </div>
</article>


                
<footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 이종학. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-bar-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/05/31/oauth2/" data-tooltip="카카오 로그인을 통한 Oauth2 이해하기" aria-label="PREVIOUS: 카카오 로그인을 통한 Oauth2 이해하기">
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">카카오 로그인을 통한 Oauth2 이해하기</span>
                
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/03/30/puppeteer/" data-tooltip="[nodejs] puppeteer 뉴스 기사 메타 정보 크롤링" aria-label="NEXT: [nodejs] puppeteer 뉴스 기사 메타 정보 크롤링">
                        <span class="hide-xs hide-sm text-small icon-mr">[nodejs] puppeteer 뉴스 기사 메타 정보 크롤링</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://devhaks.github.io/2019/04/20/session-strategy/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://devhaks.github.io/2019/04/20/session-strategy/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://devhaks.github.io/2019/04/20/session-strategy/">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://devhaks.github.io/2019/04/20/session-strategy/">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=110" alt="Author&#39;s picture">
        
            <h4 id="about-card-name">이종학</h4>
        
            <!-- <div id="about-card-bio"><p>author.bio</p>
</div> -->
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>Software developer</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-gqfkjfdb6bghizjmdhv1eect2ihkmgoyo6be4xlkou3yljsi2ml5hdwn5chn.min.js"></script>
<!--SCRIPTS END-->

    
        <script>
             var disqus_config = function () {
                 this.page.url = 'https://devhaks.github.io/2019/04/20/session-strategy/';
                 
                    this.page.identifier = '2019/04/20/session-strategy/';
                 
             };
            (function() {
                var d = document, s = d.createElement('script');
                var disqus_shortname = 'devhaks';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
    




        <script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script>
        <script>
            addBackToTop({
                cornerOffset: 70,
                scrollDuration : 250,
                diameter: 56,
                backgroundColor: 'rgb(255, 82, 82)',
                textColor: '#fff'
            })
        </script> 
    </body>
</html>
