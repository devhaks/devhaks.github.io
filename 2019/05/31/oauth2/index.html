
<!DOCTYPE html>
<html lang="en,default">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Devhaks 개발 저장소">
    <title>카카오 로그인 연동을 통한 OAuth2 이해하기 - Devhaks 개발 저장소</title>
    <meta name="author" content="이종학">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"이종학","sameAs":["https://github.com/devhaks/"],"image":"https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d"},"articleBody":"\n\n들어가기 앞서 코드의 설명은 nodejs + express 로 하겠습니다.전체 소스 코드는 gitHub 를 참고하시면 됩니다.\n목차\n배경\n\nOAuth 란\n\nOAuth2 역할\nOAuth2 토큰\n\n\n소셜 로그인\n\n서버 설정\n\n카카오 개발자 어플리케이션 등록하기\n\n카카오 로그인 구현\n\n마치며\n\n참고\n\n\n배경소셜 로그인이란 단어가 나온지 오래 되었는데, 저희 회사 서비스에 소셜 로그인을 기능을 구현하기 위해 이제서야 파헤쳐 보려 합니다.\n소셜 로그인 단어를 처음 들었을 때, ‘어떻게 구글이나 페이스북으로 가입한 적이 없는 서비스에 로그인을 할 수 있지?’ 의문이 들었습니다.\n이미 소셜 로그인에 대한 블로그는 많지만 개념보다는 구현에 가까운 내용이 많아서 의문점이 풀리질 않았습니다. \n그래서 OAuth2 를 정확히 이해하기 위해 준비했습니다. 또한 OAuth2 를 이해하고 소셜 로그인을 라이브러리 없이 직접 구현하려고 합니다.\nOAuth 란위키백과 정의에 따르면, OAuth는 인터넷 사용자들이 비밀번호를 제공하지 않고 다른 웹사이트 상의 자신들의 정보에 대해 웹사이트나 애플리케이션의 접근 권한을 부여할 수 있는 공통적인 수단으로서 사용되는, 접근 위임을 위한 개방형 표준입니다. 사용자가 애플리케이션에게 모든 권한을 넘기지 않고 사용자 대신 서비스를 이용할 수 있게 해주는 HTTP 기반의 보안 프로토콜 입니다.\nOAuth를 사용하는 서비스 제공자는 대표적으로 구글, 페이스북 등이 있습니다. 국내에는 대표적으로 네이버와 카카오가 있죠. \nOAuth 에서 Auth는 Authentication(인증) &amp; Authorization(허가) 2가지 의미를 포함하고 있습니다. 예를 들어 ‘서비스 제공자를 대신하여 제 3자가 어떤 정보를 사용하도록 접근을 허용하겠는가?’ 라는 물음을 보신적이 있으실 겁니다. 여기서 제 3자는 여러분들이 이용 할 서비스 입니다. 이 물음에 동의하면, 먼저 서비스 제공자에게 자신을 인증하고 제 3자에게 자신의 정보를 사용하도록 접근 권한을 부여 하는 것입니다.\nOAuth 로 인해 사용자 입장에서는 더욱더 여러 서비스들을 하나의 계정으로 관리할 수 있게되어 편해지고 개발자 입장에서는 민감한 사용자 정보를 다루지 않아 위험 부담이 줄고 서비스 제공자로 부터 사용자 정보를 활용 할 수 있기 때문에 장점이 상당히 많습니다.\nOAuth2 역할OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/\n\n위 이미지를 보시면, 총 4가지 역할로 구분 할 수 있습니다.\n\n자원 소유자 (Resource Owner) \n\n정보의 소유권을 가진 사용자입니다. \n\n\n자원 서버 (Resource Server) \n\n자원 소유자(Resource Owner)의 정보를 보관하고 있는 서버입니다. \n구글, 페이스북, 네이버, 카카오 등이 있습니다. \n\n\n인가 서버 (Authorization Server)\n\n자원 소유자 (Resource Owner) 을 인증합니다.\nClient 에게 Access token 을 발행합니다.\n\n\n클라이언트 (Client) \n\n제 3자 어플리케이션을 의미합니다.\n이는 사용자 동의하에 Resource Server 에 사용자의 특정 정보를 요청 할 수 있습니다.\n\n\n\nResource Server 와 Authorization Server 를 구축한 대상을 Provider 라고 부르기도 합니다.\n\n\nOAuth2 토큰Authorization Server 로 부터 발급된 랜덤한 문자열입니다. 위 이미지에서 4번 단계에 열쇠 모양으로 표시되고 있으며 토큰은 2가지 종류가 있습니다.\n\nAccess Token\n\nClient 가 Resource Server 에게 사용자 정보를 요청하기 위한 입장권 같은 것입니다.\n입장권에는 유효기간이 있습니다. 각 provider 마다 다릅니다.\n유효 기간이 지나면 더 이상 이 토큰을 사용 할 수 없습니다.\n\n\nRefresh Token\n\n위 Access Token 이 유효기간이 만료 되면, 새로운 Access Token 을 발급 받기 위해 필요한 토큰입니다.\n이 토큰에도 유효기간이 있습니다. 각 provider 마다 다릅니다. Access Token 보다는 유효기간이 훨씬 깁니다.\n\n\n\n소셜 로그인제가 가진 의문인 ‘어떻게 구글이나 페이스북으로 가입한 적이 없는 서비스에 로그인을 할 수 있지?’라는게 풀리는 부분입니다.\n글의 제목에서 카카오 로그인 연동 이라는 단어를 사용했습니다. 연동을 하기 위해서는 필수로 서비스에 가입된 상태여야 합니다. 다음으로 서비스 제공자로 부터 사용자 인증 및 허가를 받습니다. 인증자의 정보를 받아 가입한 계정에 저장을 하면 연동이 되는 것입니다. 연동된 계정으로 로그인 시도 시, 서비스 제공자로 부터 재확인이 완료되면, 이 과정이 바로 소셜 로그인 입니다. (ID/PW 로그인이 아님.)\n제 3자 서비스의 백앤드 로직에 따라 최초 소셜 로그인 시도 시, 회원가입 및 로그인을 따로 진행하는 경우가 있고 한번에 진행하는 경우가 있습니다.\n잠깐 다른 얘기를 꺼내면, 사실 서비스 상황에 따라 DB에 회원 계정을 생성 할 필요는 없습니다. 왜냐하면 Access token 만 사용하여 단순한 기능만을 제공해도 충분하다면 말이죠. 예로 카카오톡 나에게 보내기 기능 처럼 사용자 정보가 필요 없는 Access token 만 갖고도 충분한 상황입니다.\n하지만, 위와 같은 경우는 거의 없을 것입니다. 사용자의 데이터를 DB에 저장하고 이를 분석하여 적절한 맞춤형 정보를 제공하기 위해서는 계정이 필요하기 때문이죠. \n서버 설정구현하기 앞서, 서버 설정에 대한 설명입니다.\n\nClient base Url: http://localhost:8888\n\n사용자 계정은 DB 대신 서버에서 생성한 사용자별 session 파일(.json)로 대신하였습니다.\n\n\n카카오 개발자 어플리케이션 등록하기\n카카오 개발자 콘솔 로 접속하여 애플리케이션을 생성하고 아래와 같이 clientID, clientSecret, redirect path 를 설정합니다.\n\n\n카카오 개발자 콘솔 설정 - 사용자 관리\n\n\n카카오 개발자 콘솔 설정 - 사용자 관리 - 로그인 동의 항목 이메일 설정\n\n\n카카오 개발자 콘솔 설정 - 일반\n\n\n카카오 개발자 콘솔 설정 - 고급\n\n\nclientID, clientSecret, redirectUri 설정123456// routes/auth/kakao.jsconst kakao = &#123;  clientID: \"803fa52145da1c0cc9a748018a95d136\",  clientSecret: \"BtSD12taxk3DqusTvOjGBQv2MbZoViI3\",  redirectUri: \"http://localhost:8888/auth/kakao/callback\"&#125;;\n\n\n\n카카오 로그인 구현OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/\n\n위 이미지의 화살표에 번호가 1-5번까지 있습니다. 실제 구현에서 1번을 제외하고 2-5번 과정을 구현합니다. 전체 소스 코드는 gitHub 참고 바랍니다.\n\n이 과정은 provider 내부에서 이뤄지기 때문에 구현하는 부분에서 제외합니다.\n\nClient 서비스에 접속\n\n사용자는 http://localhost:8888/auth/kakao 를 클릭하여 3단계를 진행합니다.\n\n소셜 회원 가입 또는 로그인을 /auth/kakao 하나로 통합 할 수 있습니다. \n\n\n1234// views/partial/header.ejs&lt;div&gt;  &lt;a href=\"/auth/kakao\"&gt;카카오 간편 로그인&lt;/a&gt;&lt;/div&gt;\n\n사용자 인증 및 접근 권한 받기\n\n미리 카카오에 로그인 되어 있는 경우, 서비스 동의 페이지로 리다이렉트 됩니다.\n\n사용자 서비스 동의 화면\n\n\n이때 리다이렉트되는 주소를 확인하시면 /auth/kakao route 의해 생성된 주소임을 확인 할 수 있습니다. \n12345678910111213141516// routes/auth/kakao.js/*** @summary 카카오 인증 진행하기** @description* - '간편 로그인' 링크로 접근 했을 때, '사용자 서비스 동의' 페이지로 리다이렉트 합니다.* - redirectUri 는 인증 성공시, 카카오 개발자 콘솔에 기입한 이동할 주소입니다.*/// http://localhost:8888/auth/kakaorouter.get(\"/\", (req, res) =&gt; &#123;  const kakaoAuthUrl = `https://kauth.kakao.com/oauth/authorize?client_id=$&#123;    kakao.clientID  &#125;&amp;redirect_uri=$&#123;kakao.redirectUri&#125;&amp;response_type=code`;  return res.redirect(kakaoAuthUrl);&#125;);\n\n인증 완료 후, 카카오 개발자 콘솔에서 어플리케이션에 등록된 사용자 목록입니다.\n카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록\n\n\n\nAuthorization Server 부터 Access token 발급받기 &amp; 사용자 정보 요청하기\n\n3번 과정이 완료된 후, 받은 code 를 https://kauth.kakao.com/oauth/token 에 요청하여 Access token 을 받습니다.\n\n5번 과정을 이 과정에서 함께 설명하도록 하겠습니다.\n\n사용자 기본 정보를 얻기 위해 발급 받은 Access token 으로 https://kapi.kakao.com/v2/user/me 에 요청 합니다.\nlinkUser() 함수를 통해 사용자 session 정보에 Access token과 사용자 기본 정보를 저장합니다. (저장 결과는 하단 참고)\n\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102// routes/auth/kakao.js/** * @summary 사용자 계정을 provider 로 연동. 인증 정보와 함께 저장 * * @param &#123;*&#125; session 사용자 세션 * @param &#123;*&#125; provider 공급사 * @param &#123;*&#125; authData 인증 정보 */function linkUser(session, provider, authData) &#123;  let result = false;  if (session.authData) &#123;    if (session.authData[provider]) &#123;      // 이미 계정에 provider 가 연결되어 있는 경우      return result;    &#125;    session.authData[provider] = authData;  &#125; else &#123;    session.authData = &#123;      [provider]: authData    &#125;;  &#125;  result = true;  return result;&#125;/** *  * @summary '사용자 서비스 동의' 완료 후, 이동되는 주소. * * @description * - 사용자로부터 동의를 구한 후, 서비스 내에서 처리할 로직을 구현합니다. */// http://localhost:8888/auth/kakao/callbackrouter.get(\"/callback\", async (req, res) =&gt; &#123;  const &#123; session, query &#125; = req;  const &#123; code &#125; = query;  console.info(\"==== session ====\");  console.log(session);  let tokenResponse;  try &#123;    // Authorization Server 부터 Access token 발급받기    tokenResponse = await axios(&#123;      method: \"POST\",      url: 'https://kauth.kakao.com/oauth/token',      headers: &#123;        \"content-type\": \"application/x-www-form-urlencoded\"      &#125;,      data: qs.stringify(&#123;        grant_type: \"authorization_code\",        client_id: kakao.clientID,        client_secret: kakao.clientSecret,        redirect_uri: kakao.redirectUri,        code      &#125;)    &#125;);  &#125; catch (error) &#123;    return res.json(error.data);  &#125;  console.info(\"==== tokenResponse.data ====\");  console.log(tokenResponse.data);  const &#123; access_token &#125; = tokenResponse.data;  let userResponse;  try &#123;    // access_token 으로 사용자 정보 요청하기    userResponse = await axios(&#123;      method: \"GET\",      url: \"https://kapi.kakao.com/v2/user/me\",      headers: &#123;        Authorization: `Bearer $&#123;access_token&#125;`      &#125;    &#125;);  &#125; catch (error) &#123;    return res.json(error.data);  &#125;  console.info(\"==== userResponse.data ====\");  console.log(userResponse.data);  const authData = &#123;    ...tokenResponse.data,    ...userResponse.data  &#125;;  const result = linkUser(session, \"kakao\", authData);  if (result) &#123;    console.info(\"계정에 연결되었습니다.\");  &#125; else &#123;    console.warn(\"이미 연결된 계정입니다.\");  &#125;  res.redirect(\"/\");&#125;);\n\n세션 파일에 저장된 사용자 정보1234567891011121314151617181920212223242526272829303132&#123;   \"cookie\":&#123;      \"originalMaxAge\":null,    \"expires\":null,    \"httpOnly\":true,    \"path\":\"/\" &#125;, \"__lastAccess\":1559314094266, \"authData\":&#123;      \"kakao\":&#123;         \"access_token\":\"leeDsQ5cKYUqX0VmF94T4GljGEMWrDTdHMcUyworDR4AAAFrDlzUBg\",       \"token_type\":\"bearer\",       \"refresh_token\":\"0N5qjWKMCBsF4nqxoA7_lRf1d4JVQQGchRMC4worDR4AAAFrDlzUBA\",       \"expires_in\":21599,       \"scope\":\"account_email profile\",       \"refresh_token_expires_in\":2591999,       \"id\":\"xxxxxxxxxxx\",       \"properties\":&#123;            \"nickname\":\"이종학\",          \"profile_image\":\"http://k.kakaocdn.net/dn/bu6KcI/btqvJSMkboY/k9XRhVYKqKD7A75QS3gnI0/profile_640x640s.jpg\",          \"thumbnail_image\":\"http://k.kakaocdn.net/dn/bu6KcI/btqvJSMkboY/k9XRhVYKqKD7A75QS3gnI0/profile_110x110c.jpg\"       &#125;,       \"kakao_account\":&#123;            \"has_email\":true,          \"email_needs_agreement\":false,          \"is_email_valid\":true,          \"is_email_verified\":true,          \"email\":\"xxxxx@xxxx.xxx\"       &#125;    &#125;  &#125;&#125;\n\n사용자 Client 앱 연동 해제\n\nClient 앱에 대한 인증 및 허가를 철회합니다.\n\n1234// views/partial/header.ejs&lt;div&gt;  &lt;a href=\"/auth/kakao/unlink\"&gt;카카오 앱 연결 해제&lt;/a&gt;&lt;/div&gt;\n\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859// routes/auth/kakao.js/** * @summary 카카오로 연동한 계정을 연결 해제. 사용자 authData 정보 삭제. * * @param &#123;*&#125; session 사용자 세션 * @param &#123;*&#125; provider 공급사 */function unlinkUser(session, provider, userId) &#123;  let result = false;  if (    session.authData &amp;&amp;    session.authData[provider] &amp;&amp;    session.authData[provider].id === userId  ) &#123;    delete session.authData[provider];    result = true;  &#125;  return result;&#125;/** * @summary 사용자 앱 연결 해제 링크 */// http://localhost:8888/auth/kakao/unlinkrouter.get(\"/unlink\", async (req, res) =&gt; &#123;  const &#123; session &#125; = req;  const &#123; access_token &#125; = session.authData.kakao;  let unlinkResponse;  try &#123;    unlinkResponse = await axios(&#123;      method: \"POST\",      url: \"https://kapi.kakao.com/v1/user/unlink\",      headers: &#123;        Authorization: `Bearer $&#123;access_token&#125;`      &#125;    &#125;);  &#125; catch (error) &#123;    return res.json(error.data);  &#125;  console.log(\"==== unlinkResponse.data ====\");  console.log(unlinkResponse.data);  const &#123; id &#125; = unlinkResponse.data;  const result = unlinkUser(session, \"kakao\", id);  if (result) &#123;    console.log(\"연결 해제되었습니다.\");  &#125; else &#123;    console.log(\"카카오와 연동된 계정이 아닙니다.\");  &#125;  res.redirect(\"/\");&#125;);\n\n\n앱 연결 해제 후, 카카오 개발자 콘솔 사용자 목록 입니다.\n\n카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록\n\n\n\n\n마치며OAuth 로그인을 라이브러리 없이 직접 구현해봤습니다. 실제 3~4일을 삽질했던것 같네요. 이렇게 직접 구현해 본 후, 다른 provider 도 이와 같이 쉽게 구현 할 수 있을 것 같습니다.  \n참고\n생활코딩 - https://opentutorials.org/course/3405\n\n개념 및 실습 위주의 동영상 강의입니다.\n\n\n네이버 D2 - https://d2.naver.com/helloworld/24942\n\nOAuth 및 이와 관련된 내용이 잘 설명되어 있다.\n\n\n","dateCreated":"2019-05-31T21:23:28+09:00","dateModified":"2019-09-29T20:30:12+09:00","datePublished":"2019-05-31T21:23:28+09:00","description":"이번 포스팅은 사용자에게는 편하지만 개발자에게는 다소 이해하기 힘든 OAuth2 대해 설명합니다.","headline":"카카오 로그인 연동을 통한 OAuth2 이해하기","image":["thumbnail.png","cover.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://devhaks.github.io/2019/05/31/oauth2/"},"publisher":{"@type":"Organization","name":"이종학","sameAs":["https://github.com/devhaks/"],"image":"https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d"}},"url":"https://devhaks.github.io/2019/05/31/oauth2/","keywords":"OAuth2, kakao","thumbnailUrl":"thumbnail.png"}</script>
    
    
    
        
    

    
        <meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/thumbnail.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://devhaks.github.io/2019/05/31/oauth2/thumbnail.png" />
    
    
    
        <meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/cover.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://devhaks.github.io/2019/05/31/oauth2/cover.jpg" />
    
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=640"/>
    
    
    

    <meta name="description" content="OAuth2 를 이해하기 위해 카카오 로그인 연동을 통해 설명합니다.">
<meta name="keywords" content="OAuth2,kakao">
<meta property="og:type" content="blog">
<meta property="og:title" content="카카오 로그인 연동을 통한 OAuth2 이해하기">
<meta property="og:url" content="https://devhaks.github.io/2019/05/31/oauth2/index.html">
<meta property="og:site_name" content="Devhaks 개발 저장소">
<meta property="og:description" content="OAuth2 를 이해하기 위해 카카오 로그인 연동을 통해 설명합니다.">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/oauth2-flow.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/kakao-console-3.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/kakao-console-4.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/kakao-console-1.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/kakao-console-2.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/oauth2-flow.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/kakao-agreement.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/kakao-app-user-1.png">
<meta property="og:image" content="https://devhaks.github.io/2019/05/31/oauth2/kakao-app-user-2.png">
<meta property="og:updated_time" content="2019-09-29T11:30:12.782Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="카카오 로그인 연동을 통한 OAuth2 이해하기">
<meta name="twitter:description" content="OAuth2 를 이해하기 위해 카카오 로그인 연동을 통해 설명합니다.">
<meta name="twitter:image" content="https://devhaks.github.io/2019/05/31/oauth2/oauth2-flow.png">


    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-dig2yh02rpgcdxsbsfha8ujj65grwfvm3xbp1gpa6w8uj8k150ymhv97ed5p.min.css">
    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135461398-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-135461398-1');
    </script>


    
</head>

    <body>
        
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Devhaks 개발 저장소</a>
    </div>

    <div class="progress-container">
        <div class="progress-bar" id="myBar"></div>
    </div>
    


    
        
            <a  class="header-right-picture "
                href="/me">
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=90" alt="Author&#39;s picture"/>
        
        </a>
    
</header>


<style>
    /* The progress container (grey background) */
    .progress-container {
        width: 100%;
        height: 10px;
        background: #ccc;
        
    }
    /* The progress bar (scroll indicator) */
    .progress-bar {
        height: 10px;
        background: #ff5151;
        width: 0%;
    }
</style>

<script>
    // When the user scrolls the page, execute myFunction 
    window.onscroll = function() {myFunction()};

    function myFunction() {
        var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
        var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        var scrolled = (winScroll / height) * 100;
        document.getElementById("myBar").style.width = scrolled + "%";
    }
</script>
            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=110" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">이종학</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Search"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/me"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/devhaks/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-left
                    post-header-cover--full"
             style="background-image:url('/2019/05/31/oauth2/cover.jpg');"
             data-behavior="5">
            
                <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            카카오 로그인 연동을 통한 OAuth2 이해하기
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-05-31T21:23:28+09:00">
	
		    May 31, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Server/">Server</a>, <a class="category-link" href="/categories/Server/Web/">Web</a>


    
</div>

    
</div>

            
        </div>

            <div id="main" data-behavior="5"
                 class="hasCover
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    

    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- excerpt -->

<p>들어가기 앞서 코드의 설명은 nodejs + express 로 하겠습니다.<br>전체 소스 코드는 <a href="https://github.com/devhaks/myNode/tree/social_login" target="_blank" rel="noopener">gitHub</a> 를 참고하시면 됩니다.</p>
<h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul>
<li><p><a href="#배경">배경</a></p>
</li>
<li><p><a href="#OAuth-란">OAuth 란</a></p>
<ul>
<li><a href="#OAuth2-역할">OAuth2 역할</a></li>
<li><a href="#OAuth2-토큰">OAuth2 토큰</a></li>
</ul>
</li>
<li><p><a href="#소셜-로그인">소셜 로그인</a></p>
</li>
<li><p><a href="#서버-설정">서버 설정</a></p>
</li>
<li><p><a href="#카카오-개발자-어플리케이션-등록하기">카카오 개발자 어플리케이션 등록하기</a></p>
</li>
<li><p><a href="#카카오-로그인-구현">카카오 로그인 구현</a></p>
</li>
<li><p><a href="#마치며">마치며</a></p>
</li>
<li><p><a href="#참고">참고</a></p>
</li>
</ul>
<h2 id="배경"><a href="#배경" class="headerlink" title="배경"></a>배경</h2><p>소셜 로그인이란 단어가 나온지 오래 되었는데, 저희 회사 서비스에 소셜 로그인을 기능을 구현하기 위해 이제서야 파헤쳐 보려 합니다.</p>
<p>소셜 로그인 단어를 처음 들었을 때, <u>‘어떻게 구글이나 페이스북으로 가입한 적이 없는 서비스에 로그인을 할 수 있지?’</u> 의문이 들었습니다.</p>
<p>이미 소셜 로그인에 대한 블로그는 많지만 개념보다는 구현에 가까운 내용이 많아서 의문점이 풀리질 않았습니다. </p>
<p>그래서 OAuth2 를 정확히 이해하기 위해 준비했습니다. 또한 OAuth2 를 이해하고 소셜 로그인을 라이브러리 없이 직접 구현하려고 합니다.</p>
<h2 id="OAuth-란"><a href="#OAuth-란" class="headerlink" title="OAuth 란"></a>OAuth 란</h2><p>위키백과 정의에 따르면, OAuth는 인터넷 사용자들이 비밀번호를 제공하지 않고 다른 웹사이트 상의 자신들의 정보에 대해 웹사이트나 애플리케이션의 접근 권한을 부여할 수 있는 공통적인 수단으로서 사용되는, 접근 위임을 위한 개방형 표준입니다. 사용자가 애플리케이션에게 <u>모든 권한을 넘기지 않고 사용자 대신 서비스를 이용할 수 있게 해주는</u> HTTP 기반의 보안 프로토콜 입니다.</p>
<p>OAuth를 사용하는 서비스 제공자는 대표적으로 구글, 페이스북 등이 있습니다. 국내에는 대표적으로 네이버와 카카오가 있죠. </p>
<p>OAuth 에서 Auth는 Authentication(인증) &amp; Authorization(허가) 2가지 의미를 포함하고 있습니다. 예를 들어 <u>‘서비스 제공자를 대신하여 제 3자가 어떤 정보를 사용하도록 접근을 허용하겠는가?’</u> 라는 물음을 보신적이 있으실 겁니다. 여기서 제 3자는 여러분들이 이용 할 서비스 입니다. 이 물음에 동의하면, 먼저 서비스 제공자에게 자신을 인증하고 제 3자에게 자신의 정보를 사용하도록 접근 권한을 부여 하는 것입니다.</p>
<p>OAuth 로 인해 사용자 입장에서는 더욱더 여러 서비스들을 하나의 계정으로 관리할 수 있게되어 편해지고 개발자 입장에서는 민감한 사용자 정보를 다루지 않아 위험 부담이 줄고 서비스 제공자로 부터 사용자 정보를 활용 할 수 있기 때문에 장점이 상당히 많습니다.</p>
<h4 id="OAuth2-역할"><a href="#OAuth2-역할" class="headerlink" title="OAuth2 역할"></a>OAuth2 역할</h4><div class="figure center" style="width:;"><a class="fancybox" href="oauth2-flow.png" title="OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/" data-caption="OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/" data-fancybox="travel"><img class="fig-img" src="oauth2-flow.png" alt="OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/"></a><span class="caption">OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/</span></div><div style="clear:both;"></div>

<p>위 이미지를 보시면, 총 4가지 역할로 구분 할 수 있습니다.<br><br></p>
<ol>
<li><p>자원 소유자 (Resource Owner) </p>
<ul>
<li>정보의 소유권을 가진 사용자입니다. </li>
</ul>
</li>
<li><p>자원 서버 (Resource Server) </p>
<ul>
<li>자원 소유자(Resource Owner)의 정보를 보관하고 있는 서버입니다. </li>
<li>구글, 페이스북, 네이버, 카카오 등이 있습니다. </li>
</ul>
</li>
<li><p>인가 서버 (Authorization Server)</p>
<ul>
<li>자원 소유자 (Resource Owner) 을 인증합니다.</li>
<li>Client 에게 Access token 을 발행합니다.</li>
</ul>
</li>
<li><p>클라이언트 (Client) </p>
<ul>
<li>제 3자 어플리케이션을 의미합니다.</li>
<li>이는 사용자 동의하에 Resource Server 에 사용자의 특정 정보를 요청 할 수 있습니다.</li>
</ul>
</li>
</ol>
<div class="alert info"><p>Resource Server 와 Authorization Server 를 구축한 대상을 Provider 라고 부르기도 합니다.</p>
</div>

<h4 id="OAuth2-토큰"><a href="#OAuth2-토큰" class="headerlink" title="OAuth2 토큰"></a>OAuth2 토큰</h4><p>Authorization Server 로 부터 발급된 랜덤한 문자열입니다. 위 이미지에서 4번 단계에 열쇠 모양으로 표시되고 있으며 토큰은 2가지 종류가 있습니다.<br><br></p>
<ol>
<li><p>Access Token</p>
<ul>
<li>Client 가 Resource Server 에게 사용자 정보를 요청하기 위한 입장권 같은 것입니다.</li>
<li>입장권에는 유효기간이 있습니다. 각 provider 마다 다릅니다.</li>
<li>유효 기간이 지나면 더 이상 이 토큰을 사용 할 수 없습니다.</li>
</ul>
</li>
<li><p>Refresh Token</p>
<ul>
<li>위 Access Token 이 유효기간이 만료 되면, 새로운 Access Token 을 발급 받기 위해 필요한 토큰입니다.</li>
<li>이 토큰에도 유효기간이 있습니다. 각 provider 마다 다릅니다. Access Token 보다는 유효기간이 훨씬 깁니다.</li>
</ul>
</li>
</ol>
<h2 id="소셜-로그인"><a href="#소셜-로그인" class="headerlink" title="소셜 로그인"></a>소셜 로그인</h2><p>제가 가진 의문인 <u>‘어떻게 구글이나 페이스북으로 가입한 적이 없는 서비스에 로그인을 할 수 있지?’</u>라는게 풀리는 부분입니다.</p>
<p>글의 제목에서 카카오 로그인 <code>연동</code> 이라는 단어를 사용했습니다. 연동을 하기 위해서는 필수로 서비스에 가입된 상태여야 합니다. 다음으로 서비스 제공자로 부터 사용자 인증 및 허가를 받습니다. 인증자의 정보를 받아 가입한 계정에 저장을 하면 <code>연동</code>이 되는 것입니다. 연동된 계정으로 로그인 시도 시, 서비스 제공자로 부터 재확인이 완료되면, 이 과정이 바로 <code>소셜 로그인</code> 입니다. (ID/PW 로그인이 아님.)</p>
<p>제 3자 서비스의 백앤드 로직에 따라 최초 소셜 로그인 시도 시, 회원가입 및 로그인을 따로 진행하는 경우가 있고 한번에 진행하는 경우가 있습니다.</p>
<p>잠깐 다른 얘기를 꺼내면, 사실 서비스 상황에 따라 DB에 회원 계정을 생성 할 필요는 없습니다. 왜냐하면 Access token 만 사용하여 단순한 기능만을 제공해도 충분하다면 말이죠. 예로 <a href="#https://developers.kakao.com/docs/restapi/kakaotalk-api#나에게-보내기">카카오톡 나에게 보내기</a> 기능 처럼 사용자 정보가 필요 없는 Access token 만 갖고도 충분한 상황입니다.</p>
<p>하지만, 위와 같은 경우는 거의 없을 것입니다. 사용자의 데이터를 DB에 저장하고 이를 분석하여 적절한 맞춤형 정보를 제공하기 위해서는 계정이 필요하기 때문이죠. </p>
<h2 id="서버-설정"><a href="#서버-설정" class="headerlink" title="서버 설정"></a>서버 설정</h2><p>구현하기 앞서, 서버 설정에 대한 설명입니다.</p>
<ul>
<li><p>Client base Url: <a href="http://localhost:8888" target="_blank" rel="noopener">http://localhost:8888</a></p>
</li>
<li><p>사용자 계정은 DB 대신 서버에서 생성한 사용자별 session 파일(.json)로 대신하였습니다.</p>
</li>
</ul>
<h2 id="카카오-개발자-어플리케이션-등록하기"><a href="#카카오-개발자-어플리케이션-등록하기" class="headerlink" title="카카오 개발자 어플리케이션 등록하기"></a>카카오 개발자 어플리케이션 등록하기</h2><ul>
<li><a href="https://developers.kakao.com/" target="_blank" rel="noopener">카카오 개발자 콘솔</a> 로 접속하여 애플리케이션을 생성하고 아래와 같이 <code>clientID, clientSecret, redirect path</code> 를 설정합니다.</li>
</ul>
<ol>
<li><div class="figure center" style="width:100%;"><a class="fancybox" href="kakao-console-3.png" title="카카오 개발자 콘솔 설정 - 사용자 관리" data-caption="카카오 개발자 콘솔 설정 - 사용자 관리" data-fancybox="travel"><img class="fig-img" src="kakao-console-3.png" style="width:100%;" alt="카카오 개발자 콘솔 설정 - 사용자 관리"></a><span class="caption">카카오 개발자 콘솔 설정 - 사용자 관리</span></div><div style="clear:both;"></div>
<br>
</li>
<li><div class="figure center" style="width:100%;"><a class="fancybox" href="kakao-console-4.png" title="카카오 개발자 콘솔 설정 - 사용자 관리 - 로그인 동의 항목 이메일 설정" data-caption="카카오 개발자 콘솔 설정 - 사용자 관리 - 로그인 동의 항목 이메일 설정" data-fancybox="travel"><img class="fig-img" src="kakao-console-4.png" style="width:100%;" alt="카카오 개발자 콘솔 설정 - 사용자 관리 - 로그인 동의 항목 이메일 설정"></a><span class="caption">카카오 개발자 콘솔 설정 - 사용자 관리 - 로그인 동의 항목 이메일 설정</span></div><div style="clear:both;"></div>
<br>
</li>
<li><div class="figure center" style="width:100%;"><a class="fancybox" href="kakao-console-1.png" title="카카오 개발자 콘솔 설정 - 일반" data-caption="카카오 개발자 콘솔 설정 - 일반" data-fancybox="travel"><img class="fig-img" src="kakao-console-1.png" style="width:100%;" alt="카카오 개발자 콘솔 설정 - 일반"></a><span class="caption">카카오 개발자 콘솔 설정 - 일반</span></div><div style="clear:both;"></div>
<br>
</li>
<li><div class="figure center" style="width:100%;"><a class="fancybox" href="kakao-console-2.png" title="카카오 개발자 콘솔 설정 - 고급" data-caption="카카오 개발자 콘솔 설정 - 고급" data-fancybox="travel"><img class="fig-img" src="kakao-console-2.png" style="width:100%;" alt="카카오 개발자 콘솔 설정 - 고급"></a><span class="caption">카카오 개발자 콘솔 설정 - 고급</span></div><div style="clear:both;"></div>
<br>

<h5 id="clientID-clientSecret-redirectUri-설정"><a href="#clientID-clientSecret-redirectUri-설정" class="headerlink" title="clientID, clientSecret, redirectUri 설정"></a>clientID, clientSecret, redirectUri 설정</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes/auth/kakao.js</span></span><br><span class="line"><span class="keyword">const</span> kakao = &#123;</span><br><span class="line">  clientID: <span class="string">"803fa52145da1c0cc9a748018a95d136"</span>,</span><br><span class="line">  clientSecret: <span class="string">"BtSD12taxk3DqusTvOjGBQv2MbZoViI3"</span>,</span><br><span class="line">  redirectUri: <span class="string">"http://localhost:8888/auth/kakao/callback"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="카카오-로그인-구현"><a href="#카카오-로그인-구현" class="headerlink" title="카카오 로그인 구현"></a>카카오 로그인 구현</h2><div class="figure center" style="width:;"><a class="fancybox" href="oauth2-flow.png" title="OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/" data-caption="OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/" data-fancybox="travel"><img class="fig-img" src="oauth2-flow.png" alt="OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/"></a><span class="caption">OAuth2 설계도 이미지 출처 - http://blogs.innovationm.com/spring-security-with-oauth2/</span></div><div style="clear:both;"></div>

<p>위 이미지의 화살표에 번호가 1-5번까지 있습니다. 실제 구현에서 1번을 제외하고 2-5번 과정을 구현합니다. 전체 소스 코드는 <a href="https://github.com/devhaks/myNode/tree/social_login" target="_blank" rel="noopener">gitHub</a> 참고 바랍니다.<br><br></p>
<ol>
<li><p>이 과정은 provider 내부에서 이뤄지기 때문에 구현하는 부분에서 제외합니다.</p>
</li>
<li><p>Client 서비스에 접속</p>
<ul>
<li><p>사용자는 <a href="http://localhost:8888/auth/kakao" target="_blank" rel="noopener">http://localhost:8888/auth/kakao</a> 를 클릭하여 3단계를 진행합니다.</p>
</li>
<li><p>소셜 회원 가입 또는 로그인을 <code>/auth/kakao</code> 하나로 통합 할 수 있습니다. </p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// views/partial/header.ejs</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/auth/kakao"</span>&gt;</span>카카오 간편 로그인<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>사용자 인증 및 접근 권한 받기</p>
<ul>
<li>미리 카카오에 로그인 되어 있는 경우, 서비스 동의 페이지로 리다이렉트 됩니다.</li>
</ul>
<div class="figure center" style="width:70%;"><a class="fancybox" href="kakao-agreement.png" title="사용자 서비스 동의 화면" data-caption="사용자 서비스 동의 화면" data-fancybox="travel"><img class="fig-img" src="kakao-agreement.png" style="width:70%;" alt="사용자 서비스 동의 화면"></a><span class="caption">사용자 서비스 동의 화면</span></div><div style="clear:both;"></div>

<ul>
<li><p>이때 리다이렉트되는 주소를 확인하시면 <code>/auth/kakao</code> route 의해 생성된 주소임을 확인 할 수 있습니다. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes/auth/kakao.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @summary 카카오 인증 진행하기</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* @description</span></span><br><span class="line"><span class="comment">* - '간편 로그인' 링크로 접근 했을 때, '사용자 서비스 동의' 페이지로 리다이렉트 합니다.</span></span><br><span class="line"><span class="comment">* - redirectUri 는 인증 성공시, 카카오 개발자 콘솔에 기입한 이동할 주소입니다.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// http://localhost:8888/auth/kakao</span></span><br><span class="line">router.get(<span class="string">"/"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> kakaoAuthUrl = <span class="string">`https://kauth.kakao.com/oauth/authorize?client_id=<span class="subst">$&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">    kakao.clientID</span></span></span><br><span class="line"><span class="string"><span class="subst">  &#125;</span>&amp;redirect_uri=<span class="subst">$&#123;kakao.redirectUri&#125;</span>&amp;response_type=code`</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> res.redirect(kakaoAuthUrl);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>인증 완료 후, 카카오 개발자 콘솔에서 어플리케이션에 등록된 사용자 목록입니다.</p>
<div class="figure center" style="width:100%;"><a class="fancybox" href="kakao-app-user-1.png" title="카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록" data-caption="카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록" data-fancybox="travel"><img class="fig-img" src="kakao-app-user-1.png" style="width:100%;" alt="카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록"></a><span class="caption">카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록</span></div><div style="clear:both;"></div>
</li>
</ul>
</li>
<li><p>Authorization Server 부터 Access token 발급받기 &amp; 사용자 정보 요청하기</p>
<ul>
<li><p>3번 과정이 완료된 후, 받은 code 를 <a href="https://kauth.kakao.com/oauth/token" target="_blank" rel="noopener">https://kauth.kakao.com/oauth/token</a> 에 요청하여 Access token 을 받습니다.</p>
</li>
<li><p>5번 과정을 이 과정에서 함께 설명하도록 하겠습니다.</p>
<ul>
<li>사용자 기본 정보를 얻기 위해 발급 받은 Access token 으로 <a href="https://kapi.kakao.com/v2/user/me" target="_blank" rel="noopener">https://kapi.kakao.com/v2/user/me</a> 에 요청 합니다.</li>
<li>linkUser() 함수를 통해 사용자 session 정보에 Access token과 사용자 기본 정보를 저장합니다. (저장 결과는 하단 참고)</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes/auth/kakao.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @summary 사용자 계정을 provider 로 연동. 인증 정보와 함께 저장</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param &#123;*&#125; session 사용자 세션</span></span><br><span class="line"><span class="comment"> * @param &#123;*&#125; provider 공급사</span></span><br><span class="line"><span class="comment"> * @param &#123;*&#125; authData 인증 정보</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">linkUser</span>(<span class="params">session, provider, authData</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span> (session.authData) &#123;</span><br><span class="line">    <span class="keyword">if</span> (session.authData[provider]) &#123;</span><br><span class="line">      <span class="comment">// 이미 계정에 provider 가 연결되어 있는 경우</span></span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    session.authData[provider] = authData;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    session.authData = &#123;</span><br><span class="line">      [provider]: authData</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  result = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @summary '사용자 서비스 동의' 완료 후, 이동되는 주소.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @description</span></span><br><span class="line"><span class="comment"> * - 사용자로부터 동의를 구한 후, 서비스 내에서 처리할 로직을 구현합니다.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// http://localhost:8888/auth/kakao/callback</span></span><br><span class="line">router.get(<span class="string">"/callback"</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; session, query &#125; = req;</span><br><span class="line">  <span class="keyword">const</span> &#123; code &#125; = query;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.info(<span class="string">"==== session ===="</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(session);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> tokenResponse;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// Authorization Server 부터 Access token 발급받기</span></span><br><span class="line">    tokenResponse = <span class="keyword">await</span> axios(&#123;</span><br><span class="line">      method: <span class="string">"POST"</span>,</span><br><span class="line">      url: <span class="string">'https://kauth.kakao.com/oauth/token'</span>,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        <span class="string">"content-type"</span>: <span class="string">"application/x-www-form-urlencoded"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      data: qs.stringify(&#123;</span><br><span class="line">        grant_type: <span class="string">"authorization_code"</span>,</span><br><span class="line">        client_id: kakao.clientID,</span><br><span class="line">        client_secret: kakao.clientSecret,</span><br><span class="line">        redirect_uri: kakao.redirectUri,</span><br><span class="line">        code</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.json(error.data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.info(<span class="string">"==== tokenResponse.data ===="</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(tokenResponse.data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; access_token &#125; = tokenResponse.data;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> userResponse;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// access_token 으로 사용자 정보 요청하기</span></span><br><span class="line">    userResponse = <span class="keyword">await</span> axios(&#123;</span><br><span class="line">      method: <span class="string">"GET"</span>,</span><br><span class="line">      url: <span class="string">"https://kapi.kakao.com/v2/user/me"</span>,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        Authorization: <span class="string">`Bearer <span class="subst">$&#123;access_token&#125;</span>`</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.json(error.data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.info(<span class="string">"==== userResponse.data ===="</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(userResponse.data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> authData = &#123;</span><br><span class="line">    ...tokenResponse.data,</span><br><span class="line">    ...userResponse.data</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> result = linkUser(session, <span class="string">"kakao"</span>, authData);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">"계정에 연결되었습니다."</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">"이미 연결된 계정입니다."</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  res.redirect(<span class="string">"/"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="세션-파일에-저장된-사용자-정보"><a href="#세션-파일에-저장된-사용자-정보" class="headerlink" title="세션 파일에 저장된 사용자 정보"></a>세션 파일에 저장된 사용자 정보</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;  </span><br><span class="line"> <span class="attr">"cookie"</span>:&#123;  </span><br><span class="line">    <span class="attr">"originalMaxAge"</span>:<span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"expires"</span>:<span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"httpOnly"</span>:<span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"path"</span>:<span class="string">"/"</span></span><br><span class="line"> &#125;,</span><br><span class="line"> <span class="attr">"__lastAccess"</span>:<span class="number">1559314094266</span>,</span><br><span class="line"> <span class="attr">"authData"</span>:&#123;  </span><br><span class="line">    <span class="attr">"kakao"</span>:&#123;  </span><br><span class="line">       <span class="attr">"access_token"</span>:<span class="string">"leeDsQ5cKYUqX0VmF94T4GljGEMWrDTdHMcUyworDR4AAAFrDlzUBg"</span>,</span><br><span class="line">       <span class="attr">"token_type"</span>:<span class="string">"bearer"</span>,</span><br><span class="line">       <span class="attr">"refresh_token"</span>:<span class="string">"0N5qjWKMCBsF4nqxoA7_lRf1d4JVQQGchRMC4worDR4AAAFrDlzUBA"</span>,</span><br><span class="line">       <span class="attr">"expires_in"</span>:<span class="number">21599</span>,</span><br><span class="line">       <span class="attr">"scope"</span>:<span class="string">"account_email profile"</span>,</span><br><span class="line">       <span class="attr">"refresh_token_expires_in"</span>:<span class="number">2591999</span>,</span><br><span class="line">       <span class="attr">"id"</span>:<span class="string">"xxxxxxxxxxx"</span>,</span><br><span class="line">       <span class="attr">"properties"</span>:&#123;  </span><br><span class="line">          <span class="attr">"nickname"</span>:<span class="string">"이종학"</span>,</span><br><span class="line">          <span class="attr">"profile_image"</span>:<span class="string">"http://k.kakaocdn.net/dn/bu6KcI/btqvJSMkboY/k9XRhVYKqKD7A75QS3gnI0/profile_640x640s.jpg"</span>,</span><br><span class="line">          <span class="attr">"thumbnail_image"</span>:<span class="string">"http://k.kakaocdn.net/dn/bu6KcI/btqvJSMkboY/k9XRhVYKqKD7A75QS3gnI0/profile_110x110c.jpg"</span></span><br><span class="line">       &#125;,</span><br><span class="line">       <span class="attr">"kakao_account"</span>:&#123;  </span><br><span class="line">          <span class="attr">"has_email"</span>:<span class="literal">true</span>,</span><br><span class="line">          <span class="attr">"email_needs_agreement"</span>:<span class="literal">false</span>,</span><br><span class="line">          <span class="attr">"is_email_valid"</span>:<span class="literal">true</span>,</span><br><span class="line">          <span class="attr">"is_email_verified"</span>:<span class="literal">true</span>,</span><br><span class="line">          <span class="attr">"email"</span>:<span class="string">"xxxxx@xxxx.xxx"</span></span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>사용자 Client 앱 연동 해제</p>
<ul>
<li>Client 앱에 대한 인증 및 허가를 철회합니다.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// views/partial/header.ejs</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/auth/kakao/unlink"</span>&gt;</span>카카오 앱 연결 해제<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes/auth/kakao.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @summary 카카오로 연동한 계정을 연결 해제. 사용자 authData 정보 삭제.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param &#123;*&#125; session 사용자 세션</span></span><br><span class="line"><span class="comment"> * @param &#123;*&#125; provider 공급사</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unlinkUser</span>(<span class="params">session, provider, userId</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    session.authData &amp;&amp;</span><br><span class="line">    session.authData[provider] &amp;&amp;</span><br><span class="line">    session.authData[provider].id === userId</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">delete</span> session.authData[provider];</span><br><span class="line">    result = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @summary 사용자 앱 연결 해제 링크</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// http://localhost:8888/auth/kakao/unlink</span></span><br><span class="line">router.get(<span class="string">"/unlink"</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; session &#125; = req;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; access_token &#125; = session.authData.kakao;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> unlinkResponse;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    unlinkResponse = <span class="keyword">await</span> axios(&#123;</span><br><span class="line">      method: <span class="string">"POST"</span>,</span><br><span class="line">      url: <span class="string">"https://kapi.kakao.com/v1/user/unlink"</span>,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        Authorization: <span class="string">`Bearer <span class="subst">$&#123;access_token&#125;</span>`</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.json(error.data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"==== unlinkResponse.data ===="</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(unlinkResponse.data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = unlinkResponse.data;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> result = unlinkUser(session, <span class="string">"kakao"</span>, id);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"연결 해제되었습니다."</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"카카오와 연동된 계정이 아닙니다."</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  res.redirect(<span class="string">"/"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>앱 연결 해제 후, 카카오 개발자 콘솔 사용자 목록 입니다.</li>
</ul>
<div class="figure center" style="width:100%;"><a class="fancybox" href="kakao-app-user-2.png" title="카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록" data-caption="카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록" data-fancybox="travel"><img class="fig-img" src="kakao-app-user-2.png" style="width:100%;" alt="카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록"></a><span class="caption">카카오 개발자 콘솔 설정 - 사용자 관리 - 사용자 목록</span></div><div style="clear:both;"></div>


</li>
</ol>
<h2 id="마치며"><a href="#마치며" class="headerlink" title="마치며"></a>마치며</h2><p>OAuth 로그인을 라이브러리 없이 직접 구현해봤습니다. 실제 3~4일을 삽질했던것 같네요. 이렇게 직접 구현해 본 후, 다른 provider 도 이와 같이 쉽게 구현 할 수 있을 것 같습니다.  </p>
<h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul>
<li><p>생활코딩 - <a href="https://opentutorials.org/course/3405" target="_blank" rel="noopener">https://opentutorials.org/course/3405</a></p>
<ul>
<li>개념 및 실습 위주의 동영상 강의입니다.</li>
</ul>
</li>
<li><p>네이버 D2 - <a href="https://d2.naver.com/helloworld/24942" target="_blank" rel="noopener">https://d2.naver.com/helloworld/24942</a></p>
<ul>
<li>OAuth 및 이와 관련된 내용이 잘 설명되어 있다.</li>
</ul>
</li>
</ul>
            

        </div>
    </div>

    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/OAuth2/">OAuth2</a> <a class="tag tag--primary tag--small t-link" href="/tags/kakao/">kakao</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/06/30/docker-1/" data-tooltip="Docker 초급 (1)" aria-label="PREVIOUS: Docker 초급 (1)">
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="text-small icon-ml">Docker 초급 (1)</span>
                        <!-- <span class="hide-xs hide-sm text-small icon-ml">Docker 초급 (1)</span> -->
                
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/04/20/session-strategy/" data-tooltip="웹 서버 개발의 Session 전략" aria-label="NEXT: 웹 서버 개발의 Session 전략">
                        <span class="text-small icon-mr">웹 서버 개발의 Session 전략</span>
                        <!-- <span class="hide-xs hide-sm text-small icon-mr">웹 서버 개발의 Session 전략</span> -->
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <!-- <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li> -->
        
            
            
            <li class="post-action">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://devhaks.github.io/2019/05/31/oauth2/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://devhaks.github.io/2019/05/31/oauth2/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <!-- <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top"> -->
            
                <!-- <i class="fa fa-list" aria-hidden="true"></i> -->
            <!-- </a> -->
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://devhaks.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
            
        
    </div>
</article>


                
<footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 이종학. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-bar-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/06/30/docker-1/" data-tooltip="Docker 초급 (1)" aria-label="PREVIOUS: Docker 초급 (1)">
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">Docker 초급 (1)</span>
                
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/04/20/session-strategy/" data-tooltip="웹 서버 개발의 Session 전략" aria-label="NEXT: 웹 서버 개발의 Session 전략">
                        <span class="hide-xs hide-sm text-small icon-mr">웹 서버 개발의 Session 전략</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://devhaks.github.io/2019/05/31/oauth2/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://devhaks.github.io/2019/05/31/oauth2/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://devhaks.github.io/2019/05/31/oauth2/">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://devhaks.github.io/2019/05/31/oauth2/">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/dfca80a65a05d05bf0d417a6ca99a57d?s=110" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">이종학</h4>
        
            <!-- <div id="about-card-bio"><p>author.bio</p>
</div> -->
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Software developer</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-gqfkjfdb6bghizjmdhv1eect2ihkmgoyo6be4xlkou3yljsi2ml5hdwn5chn.min.js"></script>
<!--SCRIPTS END-->

    
        <script>
             var disqus_config = function () {
                 this.page.url = 'https://devhaks.github.io/2019/05/31/oauth2/';
                 
                    this.page.identifier = '2019/05/31/oauth2/';
                 
             };
            (function() {
                var d = document, s = d.createElement('script');
                var disqus_shortname = 'devhaks';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
    




        <script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script>
        <script>
            addBackToTop({
                cornerOffset: 70,
                scrollDuration : 250,
                diameter: 56,
                backgroundColor: 'rgb(255, 82, 82)',
                textColor: '#fff'
            })
        </script> 
    </body>
</html>
